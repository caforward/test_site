<script setup>
import { ref, onMounted, onUnmounted, onBeforeMount } from "vue";
import ModalRequisites from "./ModalRequisites.vue";
import ModalForm from "./ModalForm.vue";

const emit = defineEmits(['showModal'])

const visibility = ref(false);
const bottomMenu = ref(null);
const modalType = ref(null);
const modal = ref({
	form: false,
	requisites: false
})

const menuItems = ref([
	//   {
	//     id: 0,
	//     href: "#",
	//     modalName: "requisites",
	//     title: "Реквизиты",
	//     // title: 'Реквизиты для оплаты',
	//     icon:
	//       '<svg data-v-1c284fdc="" width="100%" height="100%" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path data-v-1c284fdc="" d="M13.0875 17.0625C12.24 17.0625 11.3475 16.86 10.425 16.47C9.525 16.0875 8.6175 15.5625 7.7325 14.925C6.855 14.28 6.0075 13.56 5.205 12.7725C4.41 11.97 3.69 11.1225 3.0525 10.2525C2.4075 9.3525 1.89 8.4525 1.5225 7.5825C1.1325 6.6525 0.9375 5.7525 0.9375 4.905C0.9375 4.32 1.0425 3.765 1.245 3.2475C1.455 2.715 1.7925 2.22 2.25 1.7925C2.8275 1.2225 3.4875 0.9375 4.1925 0.9375C4.485 0.9375 4.785 1.005 5.04 1.125C5.3325 1.26 5.58 1.4625 5.76 1.7325L7.5 4.185C7.6575 4.4025 7.7775 4.6125 7.86 4.8225C7.9575 5.0475 8.01 5.2725 8.01 5.49C8.01 5.775 7.9275 6.0525 7.77 6.315C7.6575 6.5175 7.485 6.735 7.2675 6.9525L6.7575 7.485C6.765 7.5075 6.7725 7.5225 6.78 7.5375C6.87 7.695 7.05 7.965 7.395 8.37C7.7625 8.79 8.1075 9.1725 8.4525 9.525C8.895 9.96 9.2625 10.305 9.6075 10.59C10.035 10.95 10.3125 11.13 10.4775 11.2125L10.4625 11.25L11.01 10.71C11.2425 10.4775 11.4675 10.305 11.685 10.1925C12.0975 9.9375 12.6225 9.8925 13.1475 10.11C13.3425 10.1925 13.5525 10.305 13.7775 10.4625L16.2675 12.2325C16.545 12.42 16.7475 12.66 16.8675 12.945C16.98 13.23 17.0325 13.4925 17.0325 13.755C17.0325 14.115 16.95 14.475 16.7925 14.8125C16.635 15.15 16.44 15.4425 16.1925 15.7125C15.765 16.185 15.3 16.5225 14.76 16.74C14.2425 16.95 13.68 17.0625 13.0875 17.0625ZM4.1925 2.0625C3.78 2.0625 3.3975 2.2425 3.03 2.6025C2.685 2.925 2.445 3.2775 2.295 3.66C2.1375 4.05 2.0625 4.4625 2.0625 4.905C2.0625 5.6025 2.2275 6.36 2.5575 7.14C2.895 7.935 3.3675 8.76 3.9675 9.585C4.5675 10.41 5.25 11.2125 6 11.97C6.75 12.7125 7.56 13.4025 8.3925 14.01C9.2025 14.6025 10.035 15.0825 10.86 15.4275C12.1425 15.975 13.3425 16.1025 14.3325 15.69C14.715 15.5325 15.0525 15.2925 15.36 14.9475C15.5325 14.76 15.6675 14.5575 15.78 14.3175C15.87 14.13 15.915 13.935 15.915 13.74C15.915 13.62 15.8925 13.5 15.8325 13.365C15.81 13.32 15.765 13.2375 15.6225 13.14L13.1325 11.37C12.9825 11.265 12.8475 11.19 12.72 11.1375C12.555 11.07 12.4875 11.0025 12.2325 11.16C12.0825 11.235 11.9475 11.3475 11.7975 11.4975L11.2275 12.06C10.935 12.345 10.485 12.4125 10.14 12.285L9.9375 12.195C9.63 12.03 9.27 11.775 8.8725 11.4375C8.5125 11.13 8.1225 10.77 7.65 10.305C7.2825 9.93 6.915 9.5325 6.5325 9.09C6.18 8.6775 5.925 8.325 5.7675 8.0325L5.6775 7.8075C5.6325 7.635 5.6175 7.5375 5.6175 7.4325C5.6175 7.1625 5.715 6.9225 5.9025 6.735L6.465 6.15C6.615 6 6.7275 5.8575 6.8025 5.73C6.8625 5.6325 6.885 5.55 6.885 5.475C6.885 5.415 6.8625 5.325 6.825 5.235C6.7725 5.115 6.69 4.98 6.585 4.8375L4.845 2.3775C4.77 2.2725 4.68 2.1975 4.5675 2.145C4.4475 2.0925 4.32 2.0625 4.1925 2.0625ZM10.4625 11.2575L10.3425 11.7675L10.545 11.2425C10.5075 11.235 10.4775 11.2425 10.4625 11.2575Z" fill="white"></path><path data-v-1c284fdc="" d="M13.875 7.3125C13.5675 7.3125 13.3125 7.0575 13.3125 6.75C13.3125 6.48 13.0425 5.9175 12.5925 5.4375C12.15 4.965 11.6625 4.6875 11.25 4.6875C10.9425 4.6875 10.6875 4.4325 10.6875 4.125C10.6875 3.8175 10.9425 3.5625 11.25 3.5625C11.9775 3.5625 12.7425 3.9525 13.41 4.665C14.0325 5.3325 14.4375 6.15 14.4375 6.75C14.4375 7.0575 14.1825 7.3125 13.875 7.3125Z" fill="white"></path><path data-v-1c284fdc="" d="M16.5 7.3125C16.1925 7.3125 15.9375 7.0575 15.9375 6.75C15.9375 4.1625 13.8375 2.0625 11.25 2.0625C10.9425 2.0625 10.6875 1.8075 10.6875 1.5C10.6875 1.1925 10.9425 0.9375 11.25 0.9375C14.4525 0.9375 17.0625 3.5475 17.0625 6.75C17.0625 7.0575 16.8075 7.3125 16.5 7.3125Z" fill="white"></path></svg>',
	//   },
	{
		id: 0,
		href: "#",
		modal: {
			name: "form",
			type: "installment",
		},
		title: "Рассрочка",
		icon: 'pi pi-calendar-clock'
		// icon:
		// 	'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 491.276 491.276" style="enable-background:new 0 0 491.276 491.276;" xml:space="preserve"><script xmlns=""/><g><g><g><path d="M443.436,218.278c-6.241-6.204-16.319-6.204-22.56,0l-48,48l22.56,22.56l19.04-19.04 c-13.343,105.196-109.438,179.657-214.634,166.314S20.185,326.674,33.528,221.478C45.7,125.521,127.351,53.601,224.076,53.638 v-32C100.364,21.596,0.042,121.85,0,245.562s100.212,224.034,223.924,224.076c115.375,0.039,211.907-87.563,223.032-202.4 l21.76,21.76l22.56-22.56L443.436,218.278z"/><path d="M224.076,165.638v80c-0.025,4.253,1.645,8.34,4.64,11.36l48,48l22.56-22.56l-43.2-43.36v-73.44H224.076z"/></g></g></g><script xmlns=""/></svg>',
	},
	{
		id: 2,
		href: "#",
		modal: {
			name: "form",
			type: "",
		},
		title: "Обращение",
		icon: 'pi pi-comment'
		// icon:
		// 	'<svg xmlns="http://www.w3.org/2000/svg" viewBox="-69 1 511 511.99895"><script xmlns=""/><path d="m337.953125 23.273438h-58.179687v-11.636719c0-6.425781-5.210938-11.636719-11.636719-11.636719h-162.910157c-6.425781 0-11.636718 5.210938-11.636718 11.636719v11.636719h-58.179688c-19.273437.019531-34.890625 15.636718-34.910156 34.910156v418.90625c.019531 19.269531 15.636719 34.886718 34.910156 34.910156h302.542969c19.269531-.023438 34.890625-15.640625 34.910156-34.910156v-418.90625c-.019531-19.273438-15.636719-34.890625-34.910156-34.910156zm-221.089844 0h139.636719v46.542968h-139.636719zm232.726563 453.816406c-.007813 6.421875-5.210938 11.628906-11.636719 11.636718h-302.542969c-6.425781-.007812-11.628906-5.214843-11.636718-11.636718v-418.90625c.007812-6.425782 5.210937-11.628906 11.636718-11.636719h58.179688v34.90625c0 6.425781 5.210937 11.636719 11.636718 11.636719h162.910157c6.425781 0 11.636719-5.207032 11.636719-11.636719v-34.90625h58.179687c6.425781.007813 11.628906 5.210937 11.636719 11.636719zm0 0"/><path d="m291.410156 162.910156h-209.457031c-6.425781 0-11.636719 5.207032-11.636719 11.636719 0 6.425781 5.210938 11.636719 11.636719 11.636719h209.457031c6.425782 0 11.636719-5.210938 11.636719-11.636719 0-6.429687-5.210937-11.636719-11.636719-11.636719zm0 0"/><path d="m291.410156 232.726562h-209.457031c-6.425781 0-11.636719 5.210938-11.636719 11.636719s5.210938 11.636719 11.636719 11.636719h209.457031c6.425782 0 11.636719-5.210938 11.636719-11.636719s-5.210937-11.636719-11.636719-11.636719zm0 0"/><path d="m291.410156 302.546875h-209.457031c-6.425781 0-11.636719 5.207031-11.636719 11.636719 0 6.425781 5.210938 11.636718 11.636719 11.636718h209.457031c6.425782 0 11.636719-5.210937 11.636719-11.636718 0-6.429688-5.210937-11.636719-11.636719-11.636719zm0 0"/><path d="m291.410156 372.363281h-209.457031c-6.425781 0-11.636719 5.210938-11.636719 11.636719s5.210938 11.636719 11.636719 11.636719h209.457031c6.425782 0 11.636719-5.210938 11.636719-11.636719s-5.210937-11.636719-11.636719-11.636719zm0 0"/><script xmlns=""/></svg>',
	},
	{
		id: 3,
		href: "/installment-plan#debt-form",
		title: "Оплатить",
		icon: 'pi pi-calculator'
		// icon:
		// 	'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 496 496" style="enable-background:new 0 0 496 496;" xml:space="preserve"><script xmlns=""/><g><path d="M424,0H72C32.299,0,0,32.299,0,72v352c0,39.701,32.299,72,72,72h352c39.701,0,72-32.299,72-72V72 C496,32.299,463.701,0,424,0z M480,424c0,30.878-25.122,56-56,56H72c-30.878,0-56-25.122-56-56V72c0-30.878,25.122-56,56-56h352 c30.878,0,56,25.122,56,56V424z"/><path d="M456,240H256V40c0-4.418-3.582-8-8-8s-8,3.582-8,8v200H40c-4.418,0-8,3.582-8,8s3.582,8,8,8h200v200c0,4.418,3.582,8,8,8 s8-3.582,8-8V256h200c4.418,0,8-3.582,8-8S460.418,240,456,240z"/><path d="M64,136h56v56c0,4.418,3.582,8,8,8s8-3.582,8-8v-56h56c4.418,0,8-3.582,8-8s-3.582-8-8-8h-56V64c0-4.418-3.582-8-8-8 s-8,3.582-8,8v56H64c-4.418,0-8,3.582-8,8S59.582,136,64,136z"/><path d="M304,136h128c4.418,0,8-3.582,8-8s-3.582-8-8-8H304c-4.418,0-8,3.582-8,8S299.582,136,304,136z"/><path d="M432,360H304c-4.418,0-8,3.582-8,8s3.582,8,8,8h128c4.418,0,8-3.582,8-8S436.418,360,432,360z"/><path d="M181.657,314.343c-3.124-3.124-8.189-3.124-11.313,0L128,356.687l-42.343-42.343c-3.124-3.124-8.189-3.124-11.313,0 c-3.125,3.124-3.125,8.189,0,11.313L116.687,368l-42.343,42.343c-3.125,3.124-3.125,8.189,0,11.313 C75.905,423.219,77.953,424,80,424s4.095-0.781,5.657-2.343L128,379.313l42.343,42.343c1.562,1.562,3.609,2.343,5.657,2.343 s4.095-0.781,5.657-2.343c3.125-3.124,3.125-8.189,0-11.313L139.313,368l42.343-42.343 C184.781,322.533,184.781,317.467,181.657,314.343z"/><path d="M392,320c0-13.234-10.766-24-24-24s-24,10.766-24,24s10.766,24,24,24S392,333.234,392,320z M360,320c0-4.411,3.589-8,8-8 s8,3.589,8,8s-3.589,8-8,8S360,324.411,360,320z"/><path d="M368,392c-13.234,0-24,10.766-24,24s10.766,24,24,24s24-10.766,24-24S381.234,392,368,392z M368,424c-4.411,0-8-3.589-8-8 s3.589-8,8-8s8,3.589,8,8S372.411,424,368,424z"/></g><script xmlns=""/></svg>',
	},
	{
		id: 4,
		href: "#",
		modal: {
			name: "form",
			type: "callback",
		},
		title: "Звонок",
		icon: 'pi pi-bell'
		// icon:
		// 	'<svg xmlns="http://www.w3.org/2000/svg" id="Capa_1" enable-background="new 0 0 32 32" viewBox="0 0 32 32"><script xmlns=""/><path d="m26.974 21.562c-.501-.868-.974-1.686-.974-3.562v-4c0-4.092-2.473-7.613-6-9.159v-.841c0-2.206-1.794-4-4-4s-4 1.794-4 4v.841c-3.527 1.546-6 5.067-6 9.159v4c0 1.876-.473 2.694-.974 3.562-.481.834-1.026 1.778-1.026 3.438 0 1.206.799 3 3 3h5c0 2.206 1.794 4 4 4s4-1.794 4-4h5c2.201 0 3-1.794 3-3 0-1.66-.545-2.604-1.026-3.438zm-12.974-17.562c0-1.103.897-2 2-2s2 .897 2 2v.202c-.646-.132-1.315-.202-2-.202s-1.354.07-2 .202zm2 2c4.411 0 8 3.589 8 8h-16c0-4.411 3.589-8 8-8zm-8 12v-2h16v2c0 .789.078 1.438.197 2h-16.394c.119-.562.197-1.211.197-2zm8 12c-1.103 0-2-.897-2-2h4c0 1.103-.897 2-2 2zm9-4h-18c-.805 0-.988-.55-1-1 0-1.124.318-1.676.758-2.438.102-.176.208-.365.313-.562h17.858c.105.197.211.386.312.562.441.762.759 1.314.759 2.426-.012.462-.194 1.012-1 1.012z"/><script xmlns=""/></svg>',
	},
	{
		id: 5,
		href: "tel:+78043334133",
		title: "Позвонить",
		icon: 'pi pi-phone'
		// icon:
		// 	'<svg data-v-1c284fdc="" width="100%" height="100%" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path data-v-1c284fdc="" d="M13.0875 17.0625C12.24 17.0625 11.3475 16.86 10.425 16.47C9.525 16.0875 8.6175 15.5625 7.7325 14.925C6.855 14.28 6.0075 13.56 5.205 12.7725C4.41 11.97 3.69 11.1225 3.0525 10.2525C2.4075 9.3525 1.89 8.4525 1.5225 7.5825C1.1325 6.6525 0.9375 5.7525 0.9375 4.905C0.9375 4.32 1.0425 3.765 1.245 3.2475C1.455 2.715 1.7925 2.22 2.25 1.7925C2.8275 1.2225 3.4875 0.9375 4.1925 0.9375C4.485 0.9375 4.785 1.005 5.04 1.125C5.3325 1.26 5.58 1.4625 5.76 1.7325L7.5 4.185C7.6575 4.4025 7.7775 4.6125 7.86 4.8225C7.9575 5.0475 8.01 5.2725 8.01 5.49C8.01 5.775 7.9275 6.0525 7.77 6.315C7.6575 6.5175 7.485 6.735 7.2675 6.9525L6.7575 7.485C6.765 7.5075 6.7725 7.5225 6.78 7.5375C6.87 7.695 7.05 7.965 7.395 8.37C7.7625 8.79 8.1075 9.1725 8.4525 9.525C8.895 9.96 9.2625 10.305 9.6075 10.59C10.035 10.95 10.3125 11.13 10.4775 11.2125L10.4625 11.25L11.01 10.71C11.2425 10.4775 11.4675 10.305 11.685 10.1925C12.0975 9.9375 12.6225 9.8925 13.1475 10.11C13.3425 10.1925 13.5525 10.305 13.7775 10.4625L16.2675 12.2325C16.545 12.42 16.7475 12.66 16.8675 12.945C16.98 13.23 17.0325 13.4925 17.0325 13.755C17.0325 14.115 16.95 14.475 16.7925 14.8125C16.635 15.15 16.44 15.4425 16.1925 15.7125C15.765 16.185 15.3 16.5225 14.76 16.74C14.2425 16.95 13.68 17.0625 13.0875 17.0625ZM4.1925 2.0625C3.78 2.0625 3.3975 2.2425 3.03 2.6025C2.685 2.925 2.445 3.2775 2.295 3.66C2.1375 4.05 2.0625 4.4625 2.0625 4.905C2.0625 5.6025 2.2275 6.36 2.5575 7.14C2.895 7.935 3.3675 8.76 3.9675 9.585C4.5675 10.41 5.25 11.2125 6 11.97C6.75 12.7125 7.56 13.4025 8.3925 14.01C9.2025 14.6025 10.035 15.0825 10.86 15.4275C12.1425 15.975 13.3425 16.1025 14.3325 15.69C14.715 15.5325 15.0525 15.2925 15.36 14.9475C15.5325 14.76 15.6675 14.5575 15.78 14.3175C15.87 14.13 15.915 13.935 15.915 13.74C15.915 13.62 15.8925 13.5 15.8325 13.365C15.81 13.32 15.765 13.2375 15.6225 13.14L13.1325 11.37C12.9825 11.265 12.8475 11.19 12.72 11.1375C12.555 11.07 12.4875 11.0025 12.2325 11.16C12.0825 11.235 11.9475 11.3475 11.7975 11.4975L11.2275 12.06C10.935 12.345 10.485 12.4125 10.14 12.285L9.9375 12.195C9.63 12.03 9.27 11.775 8.8725 11.4375C8.5125 11.13 8.1225 10.77 7.65 10.305C7.2825 9.93 6.915 9.5325 6.5325 9.09C6.18 8.6775 5.925 8.325 5.7675 8.0325L5.6775 7.8075C5.6325 7.635 5.6175 7.5375 5.6175 7.4325C5.6175 7.1625 5.715 6.9225 5.9025 6.735L6.465 6.15C6.615 6 6.7275 5.8575 6.8025 5.73C6.8625 5.6325 6.885 5.55 6.885 5.475C6.885 5.415 6.8625 5.325 6.825 5.235C6.7725 5.115 6.69 4.98 6.585 4.8375L4.845 2.3775C4.77 2.2725 4.68 2.1975 4.5675 2.145C4.4475 2.0925 4.32 2.0625 4.1925 2.0625ZM10.4625 11.2575L10.3425 11.7675L10.545 11.2425C10.5075 11.235 10.4775 11.2425 10.4625 11.2575Z"></path><path data-v-1c284fdc="" d="M13.875 7.3125C13.5675 7.3125 13.3125 7.0575 13.3125 6.75C13.3125 6.48 13.0425 5.9175 12.5925 5.4375C12.15 4.965 11.6625 4.6875 11.25 4.6875C10.9425 4.6875 10.6875 4.4325 10.6875 4.125C10.6875 3.8175 10.9425 3.5625 11.25 3.5625C11.9775 3.5625 12.7425 3.9525 13.41 4.665C14.0325 5.3325 14.4375 6.15 14.4375 6.75C14.4375 7.0575 14.1825 7.3125 13.875 7.3125Z"></path><path data-v-1c284fdc="" d="M16.5 7.3125C16.1925 7.3125 15.9375 7.0575 15.9375 6.75C15.9375 4.1625 13.8375 2.0625 11.25 2.0625C10.9425 2.0625 10.6875 1.8075 10.6875 1.5C10.6875 1.1925 10.9425 0.9375 11.25 0.9375C14.4525 0.9375 17.0625 3.5475 17.0625 6.75C17.0625 7.0575 16.8075 7.3125 16.5 7.3125Z"></path></svg>',
	},
]);

function windowResizeHandler() {
	visibility.value = window.matchMedia("(max-width: 1023px)").matches
}

function showModalHandler(linkModal) {
	if (linkModal.name === 'form') {
		modalType.value = linkModal.type
	}

	modal.value[linkModal.name] = true
}

onMounted(() => {
	windowResizeHandler()
	window.addEventListener("resize", windowResizeHandler)
})

onUnmounted(() => {
	window.removeEventListener("resize", windowResizeHandler)
})
</script>

<template>
	<div v-if="visibility" ref="bottomMenu" class="bottom-menu">

		<ul class="bottom-menu-list">
			<li v-for="link in menuItems" :key="link.id" class="bottom-menu-list__item">
				<a v-if="link.modal && link.modal.name" :href="link.href" class="group/link bottom-menu-list-link"
					@click.prevent="showModalHandler(link.modal)">
					<!-- <span class="bottom-menu-list-link__icon" v-html="link.icon"></span> -->
					<i
						:class="`${link.icon} text-sky-500 !text-xl group-hover/link:text-white max-[600px]:!text-base`"></i>
					<span>
						{{ link.title }}
					</span>
				</a>

				<a v-else-if="link.href.startsWith('tel:')" :href="link.href" class="group/link bottom-menu-list-link">
					<!-- <span class="bottom-menu-list-link__icon" v-html="link.icon"></span> -->
					<i
						:class="`${link.icon} text-sky-500 !text-xl group-hover/link:text-white max-[600px]:!text-base`"></i>
					<span>
						{{ link.title }}
					</span>
				</a>

				<a v-else :href="link.href" class="group/link bottom-menu-list-link">
					<!-- <span class="bottom-menu-list-link__icon" v-html="link.icon"></span> -->
					<i
						:class="`${link.icon} text-sky-500 !text-xl group-hover/link:text-white max-[600px]:!text-base`"></i>
					<span>
						{{ link.title }}
					</span>
				</a>
			</li>
		</ul>
	</div>
	<ModalRequisites v-model="modal.requisites" />
	<ModalForm v-model="modal.form" :type="modalType" />
</template>

<style lang="scss" scoped>
.bottom-menu {
	position: sticky;
	bottom: 0;
	left: 0;
	width: 100%;
	z-index: 9;
	padding: 10px;

	&-list {
		border-radius: 10px;
		overflow: hidden;
		border: 1px solid #EAECEE;
		// background-color: rgba(255, 255, 255, .01);
		// box-shadow: 0 1px 0 0 #e0edf6 inset;
		// backdrop-filter: blur(8px);
		background-color: #fff;
		display: flex;
		height: 100%;

		&__item {
			display: flex;
			align-items: center;
			width: 20%;
		}

		&-link {
			display: flex;
			flex-direction: column;
			align-items: center;
			// color: #fff;
			color: #000;
			width: 100%;
			height: 100%;
			padding: 10px;
			text-align: center;
			font-size: 13px;
			// background-color: $black-gray;
			gap: 10px;
			transition: color 0.2s, background-color 0.2s;

			&:hover {
				background-color: $blue;
				color: white;
			}

			&:active {
				background-color: $blue-light;
			}

			&__icon {
				width: 24px;
				height: 24px;
				fill: $blue;
				transition: fill 0.2s;
			}
		}
	}
}

@include mobile {
	.bottom-menu {
		padding: 5px;

		&-list {
			&-link {
				padding: 8px;
				gap: 6px;
				font-size: 10px;
			}
		}
	}
}

@include mobileS {
	.bottom-menu {
		&-list {
			&-link {
				font-size: 3vw;
			}
		}
	}
}
</style>
